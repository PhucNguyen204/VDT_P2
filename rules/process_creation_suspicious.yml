title: Suspicious Process Creation
id: 12345678-1234-1234-1234-123456789abc
description: Detects suspicious process creation activities
author: EDR Security Team
date: 2024-01-01
level: high
tags:
  - attack.execution
  - attack.t1059
  - attack.defense_evasion
  - attack.t1055
logsource:
  category: process_creation
  product: windows
detection:
  selection_powershell:
    EventID: 1
    Image|endswith: '\powershell.exe'
    CommandLine|contains:
      - 'Invoke-Expression'
      - 'IEX'
      - 'DownloadString'
      - 'EncodedCommand'
      - '-enc'
      - 'bypass'
      - 'hidden'
  selection_cmd_suspicious:
    EventID: 1
    Image|endswith: '\cmd.exe'
    CommandLine|contains:
      - '/c echo'
      - 'del /f'
      - 'taskkill /f'
      - 'reg delete'
      - 'wmic'
  selection_renamed_tools:
    EventID: 1
    CommandLine|contains:
      - 'whoami'
      - 'systeminfo'
      - 'ipconfig'
      - 'netstat'
      - 'tasklist'
    Image|endswith:
      - '.tmp'
      - '.dat'
      - '.txt'
  condition: selection_powershell or selection_cmd_suspicious or selection_renamed_tools
falsepositives:
  - Legitimate administrative scripts
  - Software installation procedures
references:
  - https://attack.mitre.org/techniques/T1059/
  - https://attack.mitre.org/techniques/T1055/
